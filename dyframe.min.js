/*!
 * Dyframe
 * @version 0.3.0
 * @link https://github.com/htanjo/dyframe
 * @author Tanjo, Hiroyuki
 * @license MIT
 */
!function(t,e,i){"use strict";var o={smartphone:{width:980,deviceWidth:375},tablet:{width:980,deviceWidth:768}},r="df-",n={html:"",width:980,deviceWidth:null,profile:null},s=function(t,i){this.element=t,this.wrapper=e.createElement("div"),this.viewport=e.createElement("iframe"),a(this.element,r+"element"),p(this.wrapper,{position:"relative",display:"block",height:0,padding:0,overflow:"hidden"}),p(this.viewport,{position:"absolute",top:0,left:0,bottom:0,height:"100%",width:"100%",border:0,webkitTransformOrigin:"0 0",msTransformOrigin:"0 0",transformOrigin:"0 0"}),this.wrapper.appendChild(this.viewport),this.element.appendChild(this.wrapper),this.render(i||{})};s.prototype.render=function(t){"object"==typeof t&&this.updateOptions(t),this.updateClass();var e=l(this.element);this.width=e.width,this.height=e.height,this.wrapper.style.paddingBottom=this.height+"px",this.scale(),this.viewport.contentWindow.document.open(),this.viewport.contentWindow.document.write(this.options.html),this.viewport.contentWindow.document.close()},s.prototype.updateOptions=function(t){return this.options?void h(this.options,t):void(this.options=h({},n,t))},s.prototype.hasActiveProfile=function(){return!(!this.options.profile||!o[this.options.profile])},s.prototype.updateClass=function(){d(this.element,r+"profile-"),this.hasActiveProfile()&&a(this.element,r+"profile-"+this.options.profile)},s.prototype.scale=function(){var t=this.width/this.getViewportWidth();p(this.viewport,{width:100/t+"%",height:100/t+"%",webkitTransform:"scale("+t+")",msTransform:"scale("+t+")",transform:"scale("+t+")"})},s.prototype.getViewportWidth=function(){var t=this.hasActiveProfile()?o[this.options.profile]:{width:this.options.width,deviceWidth:this.options.deviceWidth};if(!t.deviceWidth)return t.width;var e=this.getViewportData(),i=e.width;return i?"device-width"===i?t.deviceWidth:parseInt(i,10):t.width},s.prototype.getViewportData=function(){var t,i,o=e.createElement("div"),r={};return o.innerHTML=this.options.html,(t=o.querySelector('meta[name="viewport"]'))&&(i=t.getAttribute("content"))?(i.split(",").forEach(function(t){var e=t.trim().split("=");e[0]&&e[1]&&(r[e[0].trim()]=e[1].trim())}),r):r},s.addProfile=function(t,e){var i={width:n.width,deviceWidth:n.deviceWidth},r=h({},i,e);o[t]=r};var h=function(){var t,e,i=arguments[0];for(t=1;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&(i[e]=arguments[t][e]);return i},p=function(t,e){var i;for(i in e)t.style[i]=e[i]},a=function(t,e){t.classList?t.classList.add(e):t.className+=" "+e},d=function(t,e){var i=new RegExp("(^|\\s)"+e+"\\S+","g");t.className=t.className.replace(i,"")},l=function(e){var i=t.getComputedStyle(e),o=parseInt(i.getPropertyValue("padding-top"),0),r=parseInt(i.getPropertyValue("padding-left"),0),n=parseInt(i.getPropertyValue("padding-right"),0),s=parseInt(i.getPropertyValue("padding-bottom"),0),h={width:e.clientWidth-(r+n),height:e.clientHeight-(o+s)};return h};"function"==typeof define&&define.amd?define("dyframe",[],function(){return s}):"object"==typeof module&&module.exports?module.exports=s:t.Dyframe=s}(window,document);